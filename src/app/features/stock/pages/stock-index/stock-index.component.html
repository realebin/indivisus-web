<div class="container px-2">
  <div class="my-4">
    <h3 class="display-6 fw-bold text-primary">Stock Management</h3>
  </div>

  <div class="shadow-card p-4">
    <div class="d-flex justify-content-between align-items-center mb-4">
      <button
        class="btn btn-outline-primary"
        (click)="openCreateStockModal()">
        <i class="bi bi-plus-circle"></i> Add Stock
      </button>

      <button
        class="btn"
        [ngClass]="{'btn-outline-secondary': !showFilterPanel, 'btn-secondary text-white': showFilterPanel}"
        (click)="toggleFilterPanel()">
        <i class="bi bi-funnel"></i> Filter
      </button>
    </div>

    <div *ngIf="showFilterPanel" class="mb-4">
      <app-filter-panel
        title="Filter Stocks"
        [isVisible]="true"
        [sortOptions]="sortOptions"
        [searchControl]="searchFilter"
        [sortField]="sortField"
        [sortDirection]="sortDirection"
        [resultCount]="filteredStocks.length"
        (sortChange)="onSortChange($event)"
        (resetFilters)="resetFilters()"
        (doneFiltering)="toggleFilterPanel()">
      </app-filter-panel>
    </div>

    <div class="alert alert-danger" *ngIf="errorMessage">{{ errorMessage }}</div>

    <ng-container *ngIf="!isLoading; else loading">
      <app-stock-lists
        [stocks]="filteredStocks"
        (deleteStock)="deleteStock($event.toString())"
        (viewDetail)="navigateToDetail($event.toString())">
      </app-stock-lists>

      <div *ngIf="filteredStocks.length === 0 && !errorMessage" class="text-center py-5">
        <app-empty-data></app-empty-data>
      </div>
    </ng-container>

    <ng-template #loading>
      <app-loader type="loading-absolute"></app-loader>
    </ng-template>
  </div>
</div>
